<!DOCTYPE html>
<html lang="en">
<head> <!--Head Tag only inteneded for Meta-data, all to be shown should be in body-->
<meta charset="UTF-8">

<!--This is how to make comments in html-->
<title>Assignment 01</title>

<!--CSS Begins-->
<style>
  body {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    text-align: center; /* Center text for all text elements in the body */
  }
  .content {
    display: flex;
    align-items: center;
  }

  table, th, td {

    border: 1px solid rgb(247, 245, 245);
    border-collapse: collapse;
  }
  th, td {
    padding: 10px;
  }
  th {
    background-color: #787672;
  }
    table {
    margin-left: auto;
    margin-right: auto;
  }
</style>
</head>
<body>

  <h1>Singapore's Pollution Standard Index (PSI)</h1>
  <!--Timestamp-->
  <!--<h4 id="timestring">2024-02-21T01:00:49+08:00</h4>-->
  <h2 id="timestring">Retrieval date: 2/21/2024, 8:48:51 PM</h2>

  <div id="psiReadings"></div>
  <!--<h2>PSI Readings</h2>-->


<!--The JV begins now-->
<script>
async function fetchPSIData() {
  const url = 'https://api.data.gov.sg/v1/environment/psi';
  try {
    const response = await fetch(url);
    const data = await response.json();
    displayPSIReadings(data);
  } catch (error) {
    console.error('Error fetching PSI data:', error);
    document.getElementById('psiReadings').innerHTML = '<p>Error loading PSI data.</p>';

    //This is how we comment in JV
    //Time Stamp
    let timestamp = data.items[0].update_timestamp;
    let readings = data.items[0].readings;
    console.log(timestamp);
    console.log(readings);
    
    $("#timestring").text(timestamp);
  
  }
}

function displayPSIReadings(data) {
  const readings = data.items[0].readings;
  const keys = Object.keys(readings);
  let html = '<table><tr><th>Reading Type</th><th>National</th><th>South</th><th>North</th><th>East</th><th>West</th><th>Central</th></tr>';
  
  keys.forEach(key => {
    html += `<tr><td>${key}</td>`;
    const readingValues = readings[key];
    for (const region in readingValues) {
      html += `<td>${readingValues[region]}</td>`;
    }
    html += '</tr>';
  });
  
  html += '</table>';
  document.getElementById('psiReadings').innerHTML = html;
}

fetchPSIData();
</script>

</body>
</html>
